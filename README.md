# Сервис случайных пользователей

## Описание

Этот проект представляет собой веб-сервис на основе FastAPI, который получает данные случайных пользователей с API RandomUser.me, сохраняет их в базе данных PostgreSQL и отображает через веб-интерфейс с использованием шаблонов Jinja2. Приложение контейнеризировано с помощью Docker и оркестрируется через Docker Compose для удобного развертывания.

## Ключевые компоненты

- **Backend**: Приложение на FastAPI, которое обрабатывает API-запросы и рендерит HTML-шаблоны.
- **База данных**: PostgreSQL для постоянного хранения данных о пользователях и их местоположении.
- **Шаблоны**: Jinja2 для рендеринга динамических HTML-страниц.
- **Миграции**: Alembic для управления изменениями схемы базы данных.
- **Внешний API**: Интеграция с RandomUser.me для получения данных случайных пользователей.
- **Логирование**: Loguru для структурированного логирования с ротацией логов.
- **Контейнеризация**: Docker и Docker Compose для единообразного развертывания.

## Эндпоинты

- **GET `/healthcheck`**
  - **Описание**: Проверяет состояние приложения.
  - **Ответ**: JSON-объект `{"status": "ok"}`.

- **GET `/`**
  - **Описание**: Отображает список пользователей с пагинацией в виде HTML-таблицы.
  - **Параметры запроса**:
    - `page` (по умолчанию: 1): Номер текущей страницы.
    - `per_page` (по умолчанию: 10): Количество пользователей на страницу.
  - **Ответ**: HTML-страница (`home.html`) с таблицей пользователей, содержащей фото, имя, пол, email, телефон, местоположение и ссылку на детали.

- **GET `/{user_id}/`**
  - **Описание**: Отображает подробности о конкретном пользователе по его ID.
  - **Параметр пути**:
    - `user_id`: ID пользователя.
  - **Ответ**: HTML-страница (`user.html`) с данными пользователя (фото, имя, пол, email, телефон, местоположение) или сообщение об ошибке, если пользователь не найден.

- **GET `/random/`**
  - **Описание**: Отображает случайного пользователя из базы данных.
  - **Ответ**: HTML-страница (`random_user.html`) с данными пользователя и кнопками для получения другого случайного пользователя или возврата на главную страницу.

## Выбор технологий

### PostgreSQL
- **Почему выбрано**: PostgreSQL — это мощная реляционная база данных с открытым исходным кодом, поддерживающая расширенные возможности,  полнотекстовый поиск и надежные транзакции. Она подходит для хранения структурированных данных, таких как профили пользователей и их местоположение, обеспечивая целостность и масштабируемость.


### FastAPI
- **Почему выбрано**: FastAPI — современный высокопроизводительный веб-фреймворк для Python, поддерживающий асинхронное программирование, автоматическую генерацию OpenAPI-документации и валидацию данных с помощью Pydantic. 


### Jinja2
- **Почему выбрано**: Jinja2 — мощный и гибкий шаблонизатор для Python, который легко интегрируется с FastAPI для рендеринга динамических HTML-страниц. 


## Переменные окружения (.env.example)

Приложение использует переменные окружения для настройки подключения к базе данных PostgreSQL. Ниже приведено содержимое файла `.env.example`, который нужно скопировать в `.env` и настроить:

```plaintext
PG_USER=postgres
PG_PASSWORD=12345
PG_HOST=postgres
PG_PORT=5432
PG_NAME=postgres_yadro
```

## Запуск через Docker Compose


### Шаги
1. Клонируйте репозиторий:

```
git clone <URL-репозитория>
cd <директория-репозитория>
```

2. Создайте файл .env: Скопируйте .env.example в .env и при необходимости измените значения:
```
cp .env.example .env
```

3. Соберите и запустите приложение с помощью Docker Compose:
```
docker-compose up --build
```